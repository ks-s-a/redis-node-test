# Описание работы приложения

### Работа с приложением
###### Запуск приложения
```sh
$ npm run start
```
###### Получение логов об ошибках
```sh
$ npm run start -- --getErrors
```

### Составные части приложения
###### Клиент `./entities/client`.
Подключается к каналу сообщений и слушает входящие сообщения. При получении сообщения проверяет - обработано ли оно. Если сообщение не обработано, использует внешнюю функцию-обработчик и, если случилась ошибка, пишет сообщение в базу.
###### Генератор `./entities/generator`.
Через определенный интервал времени проверяет собственное состояние: если он активен, шлет сообщение, а если нет, пытается подключиться к каналу генератора. Если при подключении к каналу он видит что он там один, переключается в режим генерирования сообщений.

###### Экстрактор сообщений `./error-extractor`.
Подключается к базе, выгребает все сообщения об ошибках, выводя в консоль, и удаляет набор с ними.

### Сущности базы данных (изменяются в конфиге):
###### Каналы:
  - `messages` Канал рассылки сообщений.
  - `generator` Канал генератора.
  
###### Наборы:
  - `recievedmessages` Принятые сообщения. Используется для предотвращения множественной обработки сообщения клиентом.
  - `errors` Набор ошибок.

### Логгирование:
Имеется возможность задать переменную окружения для контроля работы приложения:
  - `client` - работа клиента
  - `generator` - работа генератора
  - `redis` - события базы данных
  - `extractor` - работа экстрактора

### Версии используемых продуктов:
  - NodeJS v0.12.17 (для проверки работы ES5 синтаксиса)
  - npm v2.15.1
  - redis v3.2.5